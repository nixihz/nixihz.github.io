<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Go+ImageMagick使用svg+png绘制复杂图片"/><meta property="og:title" content="Go+ImageMagick使用svg+png绘制复杂图片"/>
<meta property="og:description" content="Go+ImageMagick使用svg+png绘制复杂图片"/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="https://keli.tech/posts/solution/golang/go-imagemagick/"/>
<meta property="og:image" content="https://keli.tech/image/roodblauw.png"/>
<meta property="article:published_time" content="2018-06-01T00:00:00+00:00"/>
<meta property="article:modified_time" content="2018-06-01T00:00:00+00:00"/><meta property="og:site_name" content="Fnece X 的技术博客"/>
<title>Go+ImageMagick使用svg+png绘制复杂图片 | FenceX的技术博客</title>
<link rel="icon" href="/favicon.png" type="image/x-icon"/>


<link rel="stylesheet" href="/book.min.3a20e2abc07af71d43862fa164ed6b47633893071485e58289a48edfa406829b.css" integrity="sha256-OiDiq8B69x1Dhi+hZO1rR2M4kwcUheWCiaSO36QGgps="/>


<script defer="" src="/en.search.min.0daa3fe8b721cfb8cdff25c50f252cc2cdee6266d581db5a5e444198dc98b618.js" integrity="sha256-Dao/6Lchz7jN/yXFDyUsws3uYmbVgdtaXkRBmNyYthg="></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-44019270-5', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
  <link rel="stylesheet" href="/js/audiojs/custom.css"/>
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control"/>
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><img src="/image/logo.png" alt="Logo"/><span>FenceX的技术博客</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/"/>
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>









  

  






  <ul>
  
    

  <li>
    
      

  <a href="/posts/">
      博客
  </a>


    

    




  
  <ul>
    
      
        

  <li>
    
      

  <a href="/posts/tools/">
      工具
  </a>


    

    






  </li>


      
    
      
        

  <li>
    
      

  <a href="/posts/csp/">
      内容安全策略
  </a>


    

    






  </li>


      
    
      
        

  <li>
    
      

  <a href="/posts/mysql1/">
      Spark
  </a>


    

    






  </li>


      
    
      
        

  <li>
    
      

  <a href="/posts/yii2/">
      yii2
  </a>


    

    






  </li>


      
    
      
        <li>

  <a href="/posts/about-me/">
      关于我
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li>
    
      

  <a href="/database/">
      数据库
  </a>


    

    




  
  <ul>
    
      
        

  <li>
    
      

  <a href="/database/redis/">
      Redis
  </a>


    

    






  </li>


      
    
      
        

  <li>
    
      

  <a href="/database/mysql/">
      Mysql
  </a>


    

    






  </li>


      
    
  </ul>
  



  </li>


  
    

  <li>
    
      

  <a href="/concurrency/">
      高并发
  </a>


    

    




  
  <ul>
    
  </ul>
  



  </li>


  
    

  <li>
    
      

  <a href="/ideas/">
      想法💡
  </a>


    

    




  
  <ul>
    
  </ul>
  



  </li>


  
    

  <li>
    
      

  <a href="/lang/">
      编程语言
  </a>


    

    






  </li>


  
  </ul>














</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu"/>
  </label>

  <strong>Go+ImageMagick使用svg+png绘制复杂图片</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents"/>
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control"/>
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#需求-audio-preloadnoneaudio">需求 <audio preload="none" src="/audio/4b90085ccba3e856ceeec66c7256e638.mp3"></audio></a>
          <ul>
            <li></li>
            <li><a href="#先上最终最终效果">先上最终最终效果</a></li>
          </ul>
        </li>
        <li><a href="#步骤">步骤</a>
          <ul>
            <li><a href="#一go-绘制基本图形">一、go 绘制基本图形</a></li>
            <li><a href="#二imagemagick-convert把-svg-转化为-png-加阴影">二、imagemagick convert把 svg 转化为 png, 加阴影</a></li>
            <li><a href="#三处理阴影svg">三、处理阴影svg</a></li>
          </ul>
        </li>
        <li><a href="#附go代码">附go代码：</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      


<link rel="stylesheet" href=""/>


<article class="markdown">
  <h1>
    <a href="/posts/solution/golang/go-imagemagick/">Go+ImageMagick使用svg+png绘制复杂图片</a>
  </h1>
  <hr/>


<div>

  <h5>2018-06-01</h5>



  
  <div>
    
        <a href="/categories/solution/">solution</a>
  </div>
  

  
  <div>
    
        <a href="/tags/golang/">golang</a>, 
        <a href="/tags/imagemagick/">imagemagick</a>
  </div>
  


</div>


  <p></p><h2 id="需求-audio-preloadnoneaudio">需求 <audio preload="none" src="/audio/ddd1b49f8b7e626ed5445425e1de4f8b.mp3"></audio></h2>
<p>开发过程会有使用go绘制较为复杂图形的需求，比如这次，需要做一个类似拖拽图案验证码。
具体需求：</p>
<ol>
<li>4条边,凹凸平3个形状，随机组合，</li>
<li>随机位置上截图如上形状的图片，并且在原图有如上形状的阴影遮罩</li>
</ol>
<p>go自带<code>image/draw</code> package 不能绘制复杂的图形（或者说太复杂），经过尝试，可以使用go来绘制svg，再使用imagemagick来进行特效处理，最后再次使用go把图层融合在一起。</p>
<h5 id="涉及package">涉及package</h5>
<p><code>github.com/ajstarks/svgo</code>  #基本图形svg绘制<br/>
<code>github.com/gographics/imagick</code> #特效处理（需安装imagemagick)</p>
<h3 id="先上最终最终效果">先上最终最终效果</h3>
<p><img src="/image/go/gm1.png" alt="origin.png"/></p>
<p><img src="/image/go/gm2.png" alt="tile-final.png"/></p>
<h2 id="步骤">步骤</h2>
<h3 id="一go-绘制基本图形">一、go 绘制基本图形</h3>
<p>使用 svgo 来绘制 path，生成 svg，代码贴在最后</p>
<h3 id="二imagemagick-convert把-svg-转化为-png-加阴影">二、imagemagick convert把 svg 转化为 png, 加阴影</h3>
<p>注：只展示 imagemagick convert，没有融合到 go 程序里</p>
<p><img src="/image/go/gm3.png" alt="tile.png"/></p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tbody><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># ImageMagick convert 命令</span>
convert <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  <span style="color:#8045ff">\(</span> -background none MSVG:tile-cut.svg -background black -shadow 50x2+0+10 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    -gravity North -background none -extent 200x200 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    -compose over  <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    <span style="color:#8045ff">\(</span> -background none MSVG:tile-cut.svg -background white -shadow 120x6+0+0 -resize 95% <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>      -gravity center -background none -extent 200x200 <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    <span style="color:#8045ff">\)</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>    -background none -gravity NorthEast -geometry +0+0 -composite <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  <span style="color:#8045ff">\)</span> <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>  -compose over tile-line.svg -gravity center -geometry +0+0 -composite <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>tile.png
</code></pre></td></tr></tbody></table>
</div>
</div><p>代码注释：</p>
<ol>
<li>MSVG 支持svg 作为输入源，需要 imagemagick 支持 rsvg， 比如mac：
<code>brew install imagemagick --with-librsvg </code></li>
<li><code>-background black -shadow 50x2+0+10</code> 前两个数字自己调着看，影响shadow的大小和透明度，后两个是x，y轴偏移，可+可-</li>
<li><code>-background none</code> 背景透明</li>
<li>compose 两个图层组合方式， over 表示 后者在前者之上，还有其他选项，详见官网手册</li>
<li><code>-gravity North -background none -extent 200x200</code> -extent 扩展图片尺寸，-gravity North 表示扩展的时候，原图处于什么位置，North 表示北，还有NorthEast 等，详见官网手册</li>
</ol>
<h3 id="三处理阴影svg">三、处理阴影svg</h3>
<p><img src="/image/go/gm4.png" alt="tile-shadow.png"/></p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tbody><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># ImageMagick convert 命令</span>
convert -density <span style="color:#ae81ff">2400</span> -background transparent  MSVG:tile-shadow.svg <span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>-fill <span style="color:#d88200">&#34;rgba(0,0,0,0.3)&#34;</span> -opaque black -resize 200x200 tile-shadow.png
</code></pre></td></tr></tbody></table>
</div>
</div><p>代码注释：</p>
<ol>
<li>-opaque 删除图片中颜色，这里删除黑色，填充rgba(0,0,0,0.3), 否则不能转化透明度，这里用了一个trick</li>
<li>-density 2400 这里通过修改了分辨率来提高 svg 转化到 png 的细致程度，再强制 -resize 200x200</li>
</ol>
<p>完成这个小需求绕挺多弯路现总结如下：</p>
<ol>
<li>go 可以完成一些简单图形的绘制，比如shape/tile 中At方法其实是对每个点进行上色，这是 draw 包的实现</li>
<li>go 支持图层叠加，支持图层融合</li>
<li>绘制几何图形使用 svg path，很方便，go可以使用 svgo 包，但是不支持转化成png图片，也不能作为draw包的输入源</li>
<li>图片处理 使用 imagemagick, 我这里没有使用扩展把逻辑写到代码里，因为我可以把这些 tile png先生成，go直接叠加图层，降低运算，比如这次需求，4条边，3种形状(凹凸平),2个类型(外边阴影，阴影填充) ，3x3x3x3x2 = 162</li>
</ol>
<h2 id="附go代码">附go代码：</h2>




<div class="book-tabs">

  <input type="radio" class="hidden" name="tabs-go-image" id="tabs-go-image-0" checked="checked"/>
  <label for="tabs-go-image-0">
    main.go
  </label>
  <div class="book-tabs-content markdown-inner">
    <p>main.go</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tbody><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#75af00">main</span>

<span style="color:#f92672">import</span> <span style="color:#111">(</span>
	<span style="color:#d88200">&#34;image&#34;</span>
	<span style="color:#d88200">&#34;log&#34;</span>
	<span style="color:#75af00">_</span> <span style="color:#d88200">&#34;image/jpeg&#34;</span>
	<span style="color:#75af00">_</span> <span style="color:#d88200">&#34;image/png&#34;</span>
	<span style="color:#d88200">&#34;os&#34;</span>
	<span style="color:#d88200">&#34;math/rand&#34;</span>
	<span style="color:#d88200">&#34;time&#34;</span>
	<span style="color:#d88200">&#34;math&#34;</span>
	<span style="color:#d88200">&#34;image/png&#34;</span>
	<span style="color:#d88200">&#34;image/draw&#34;</span>
	<span style="color:#d88200">&#34;captcha/shape&#34;</span>
<span style="color:#111">)</span>

<span style="color:#00a8c8">func</span> <span style="color:#75af00">main</span><span style="color:#111">()</span> <span style="color:#111">{</span>

    <span style="color:#75715e">//保存svgs，
</span><span style="color:#75715e"></span>    <span style="color:#75af00">saveSvgs</span><span style="color:#111">()</span>

	<span style="color:#75af00">cutWidth</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">200</span>
	<span style="color:#75af00">top</span><span style="color:#111">,</span> <span style="color:#75af00">right</span><span style="color:#111">,</span> <span style="color:#75af00">bottom</span><span style="color:#111">,</span> <span style="color:#75af00">left</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
   
	<span style="color:#75af00">reader</span><span style="color:#111">,</span> <span style="color:#75af00">err</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">os</span><span style="color:#111">.</span><span style="color:#75af00">Open</span><span style="color:#111">(</span><span style="color:#d88200">&#34;images/14d4c647b216975cb298481f4e550ebc.jpg&#34;</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">err</span> <span style="color:#f92672">!=</span> <span style="color:#00a8c8">nil</span> <span style="color:#111">{</span>
		<span style="color:#75af00">log</span><span style="color:#111">.</span><span style="color:#75af00">Fatal</span><span style="color:#111">(</span><span style="color:#75af00">err</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#00a8c8">defer</span> <span style="color:#75af00">reader</span><span style="color:#111">.</span><span style="color:#75af00">Close</span><span style="color:#111">()</span>
	<span style="color:#75af00">m</span><span style="color:#111">,</span> <span style="color:#75af00">_</span><span style="color:#111">,</span> <span style="color:#75af00">err</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Decode</span><span style="color:#111">(</span><span style="color:#75af00">reader</span><span style="color:#111">)</span>
	<span style="color:#75af00">rgbImg</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">m</span><span style="color:#111">.(</span><span style="color:#f92672">*</span><span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">YCbCr</span><span style="color:#111">)</span>

	<span style="color:#75af00">reader2</span><span style="color:#111">,</span> <span style="color:#75af00">err</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">os</span><span style="color:#111">.</span><span style="color:#75af00">Open</span><span style="color:#111">(</span><span style="color:#d88200">&#34;tile.png&#34;</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">err</span> <span style="color:#f92672">!=</span> <span style="color:#00a8c8">nil</span> <span style="color:#111">{</span>
		<span style="color:#75af00">log</span><span style="color:#111">.</span><span style="color:#75af00">Fatal</span><span style="color:#111">(</span><span style="color:#75af00">err</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#00a8c8">defer</span> <span style="color:#75af00">reader2</span><span style="color:#111">.</span><span style="color:#75af00">Close</span><span style="color:#111">()</span>
	<span style="color:#75af00">m2</span><span style="color:#111">,</span> <span style="color:#75af00">_</span><span style="color:#111">,</span> <span style="color:#75af00">err</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Decode</span><span style="color:#111">(</span><span style="color:#75af00">reader2</span><span style="color:#111">)</span>
	<span style="color:#75af00">rgbImg2</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">m2</span><span style="color:#111">.(</span><span style="color:#f92672">*</span><span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">NRGBA64</span><span style="color:#111">)</span>

	<span style="color:#75af00">reader3</span><span style="color:#111">,</span> <span style="color:#75af00">err</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">os</span><span style="color:#111">.</span><span style="color:#75af00">Open</span><span style="color:#111">(</span><span style="color:#d88200">&#34;tile-shadow.png&#34;</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">err</span> <span style="color:#f92672">!=</span> <span style="color:#00a8c8">nil</span> <span style="color:#111">{</span>
		<span style="color:#75af00">log</span><span style="color:#111">.</span><span style="color:#75af00">Fatal</span><span style="color:#111">(</span><span style="color:#75af00">err</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#00a8c8">defer</span> <span style="color:#75af00">reader3</span><span style="color:#111">.</span><span style="color:#75af00">Close</span><span style="color:#111">()</span>
	<span style="color:#75af00">m3</span><span style="color:#111">,</span> <span style="color:#75af00">_</span><span style="color:#111">,</span> <span style="color:#75af00">err</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Decode</span><span style="color:#111">(</span><span style="color:#75af00">reader3</span><span style="color:#111">)</span>
	<span style="color:#75af00">rgbImg3</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">m3</span><span style="color:#111">.(</span><span style="color:#f92672">*</span><span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">NRGBA64</span><span style="color:#111">)</span>

	<span style="color:#75af00">randRect</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">getRandomRectangle</span><span style="color:#111">(</span><span style="color:#75af00">m</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">(),</span> <span style="color:#75af00">cutWidth</span><span style="color:#111">,</span> <span style="color:#75af00">cutWidth</span><span style="color:#111">)</span>
	<span style="color:#75af00">tile</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">shape</span><span style="color:#111">.</span><span style="color:#75af00">Tile</span><span style="color:#111">{</span><span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Pt</span><span style="color:#111">(</span><span style="color:#ae81ff">45</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">),</span> <span style="color:#75af00">cutWidth</span><span style="color:#111">,</span> <span style="color:#75af00">top</span><span style="color:#111">,</span> <span style="color:#75af00">right</span><span style="color:#111">,</span> <span style="color:#75af00">bottom</span><span style="color:#111">,</span> <span style="color:#75af00">left</span><span style="color:#111">,</span> <span style="color:#00a8c8">false</span><span style="color:#111">}</span>

    <span style="color:#75715e">// go draw 包处理代码，
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 新建图片
</span><span style="color:#75715e"></span>	<span style="color:#75af00">originImage</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">NewRGBA</span><span style="color:#111">(</span><span style="color:#75af00">rgbImg</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">())</span>
    <span style="color:#75715e">// 使用draw原图
</span><span style="color:#75715e"></span>	<span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Draw</span><span style="color:#111">(</span><span style="color:#75af00">originImage</span><span style="color:#111">,</span> <span style="color:#75af00">rgbImg</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">(),</span> <span style="color:#75af00">rgbImg</span><span style="color:#111">,</span> <span style="color:#75af00">rgbImg</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Min</span><span style="color:#111">,</span> <span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Src</span><span style="color:#111">)</span>
	<span style="color:#75715e">// 把imagemagick处理好的阴影png 绘制到图片的随机位置 randRect 之上
</span><span style="color:#75715e"></span>	<span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Draw</span><span style="color:#111">(</span><span style="color:#75af00">originImage</span><span style="color:#111">,</span> <span style="color:#75af00">randRect</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">(),</span> <span style="color:#75af00">rgbImg3</span><span style="color:#111">,</span> <span style="color:#75af00">rgbImg3</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Min</span><span style="color:#111">,</span> <span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Over</span><span style="color:#111">)</span>

	<span style="color:#75af00">f2</span><span style="color:#111">,</span> <span style="color:#75af00">_</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">os</span><span style="color:#111">.</span><span style="color:#75af00">Create</span><span style="color:#111">(</span><span style="color:#d88200">&#34;origin.png&#34;</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">defer</span> <span style="color:#75af00">f2</span><span style="color:#111">.</span><span style="color:#75af00">Close</span><span style="color:#111">()</span>
	<span style="color:#75af00">png</span><span style="color:#111">.</span><span style="color:#75af00">Encode</span><span style="color:#111">(</span><span style="color:#75af00">f2</span><span style="color:#111">,</span> <span style="color:#75af00">originImage</span><span style="color:#111">)</span>

	<span style="color:#75af00">cutImage4</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">NewRGBA</span><span style="color:#111">(</span><span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rect</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#75af00">cutWidth</span><span style="color:#111">,</span> <span style="color:#75af00">cutWidth</span><span style="color:#111">))</span>
	<span style="color:#75715e">// 在随机位置randRect 截取 tile 形状的截图
</span><span style="color:#75715e"></span>    <span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">DrawMask</span><span style="color:#111">(</span><span style="color:#75af00">cutImage4</span><span style="color:#111">,</span> <span style="color:#75af00">cutImage4</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">(),</span> <span style="color:#75af00">rgbImg</span><span style="color:#111">,</span> <span style="color:#75af00">randRect</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Min</span><span style="color:#111">,</span> <span style="color:#f92672">&amp;</span><span style="color:#75af00">tile</span><span style="color:#111">,</span> <span style="color:#75af00">tile</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Min</span><span style="color:#111">,</span> <span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Src</span><span style="color:#111">)</span>
    <span style="color:#75715e">// 在图片之上添加 imagemagick 处理好的 tile.png
</span><span style="color:#75715e"></span>	<span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Draw</span><span style="color:#111">(</span><span style="color:#75af00">cutImage4</span><span style="color:#111">,</span> <span style="color:#75af00">cutImage4</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">(),</span> <span style="color:#75af00">rgbImg2</span><span style="color:#111">,</span> <span style="color:#75af00">rgbImg2</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Min</span><span style="color:#111">,</span> <span style="color:#75af00">draw</span><span style="color:#111">.</span><span style="color:#75af00">Over</span><span style="color:#111">)</span>
	<span style="color:#75af00">f5</span><span style="color:#111">,</span> <span style="color:#75af00">_</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">os</span><span style="color:#111">.</span><span style="color:#75af00">Create</span><span style="color:#111">(</span><span style="color:#d88200">&#34;tile-final.png&#34;</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">defer</span> <span style="color:#75af00">f5</span><span style="color:#111">.</span><span style="color:#75af00">Close</span><span style="color:#111">()</span>
	<span style="color:#75af00">png</span><span style="color:#111">.</span><span style="color:#75af00">Encode</span><span style="color:#111">(</span><span style="color:#75af00">f5</span><span style="color:#111">,</span> <span style="color:#75af00">cutImage4</span><span style="color:#111">)</span>
<span style="color:#111">}</span>

<span style="color:#75715e">// 绘制svg
</span><span style="color:#75715e"></span><span style="color:#00a8c8">func</span> <span style="color:#75af00">saveSvgs</span><span style="color:#111">(){</span>
    <span style="color:#75af00">cutWidth</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">200</span>
	<span style="color:#75af00">top</span><span style="color:#111">,</span> <span style="color:#75af00">right</span><span style="color:#111">,</span> <span style="color:#75af00">bottom</span><span style="color:#111">,</span> <span style="color:#75af00">left</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>

    <span style="color:#75715e">//保存 svg 文件
</span><span style="color:#75715e"></span>	<span style="color:#75af00">tileSvg</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">shape</span><span style="color:#111">.</span><span style="color:#75af00">TileSvg</span><span style="color:#111">{</span><span style="color:#75af00">cutWidth</span><span style="color:#111">,</span> <span style="color:#75af00">top</span><span style="color:#111">,</span> <span style="color:#75af00">right</span><span style="color:#111">,</span> <span style="color:#75af00">bottom</span><span style="color:#111">,</span> <span style="color:#75af00">left</span><span style="color:#111">}</span>
	<span style="color:#75af00">tileSvg</span><span style="color:#111">.</span><span style="color:#75af00">SaveSvg</span><span style="color:#111">(</span><span style="color:#d88200">&#34;tile-cut.svg&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;stroke-width:10;stroke:White;fill:none;&#34;</span><span style="color:#111">)</span>
	<span style="color:#75af00">tileSvg</span><span style="color:#111">.</span><span style="color:#75af00">SaveSvg</span><span style="color:#111">(</span><span style="color:#d88200">&#34;tile-line.svg&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;stroke-width:2;stroke:White;fill:none;&#34;</span><span style="color:#111">)</span>
	<span style="color:#75af00">tileSvg</span><span style="color:#111">.</span><span style="color:#75af00">SaveSvg</span><span style="color:#111">(</span><span style="color:#d88200">&#34;tile-shadow.svg&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;stroke-width:2;stroke:White;fill:black;fill-opacity:0.5&#34;</span><span style="color:#111">)</span>
<span style="color:#111">}</span>

<span style="color:#75715e">// 随机获取截图位置
</span><span style="color:#75715e"></span><span style="color:#00a8c8">func</span> <span style="color:#75af00">getRandomRectangle</span><span style="color:#111">(</span><span style="color:#75af00">rectangle</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rectangle</span><span style="color:#111">,</span> <span style="color:#75af00">subWidth</span> <span style="color:#00a8c8">int</span><span style="color:#111">,</span> <span style="color:#75af00">subHeight</span> <span style="color:#00a8c8">int</span><span style="color:#111">)</span> <span style="color:#111">(</span><span style="color:#f92672">*</span><span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rectangle</span><span style="color:#111">)</span> <span style="color:#111">{</span>
	<span style="color:#75af00">bounds</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">rectangle</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">()</span>
	<span style="color:#75af00">width</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">bounds</span><span style="color:#111">.</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">X</span> <span style="color:#f92672">-</span> <span style="color:#75af00">bounds</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span>
	<span style="color:#75af00">height</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">bounds</span><span style="color:#111">.</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">Y</span> <span style="color:#f92672">-</span> <span style="color:#75af00">bounds</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span>

	<span style="color:#75af00">rand</span><span style="color:#111">.</span><span style="color:#75af00">Seed</span><span style="color:#111">(</span><span style="color:#75af00">time</span><span style="color:#111">.</span><span style="color:#75af00">Now</span><span style="color:#111">().</span><span style="color:#75af00">Unix</span><span style="color:#111">())</span>
	<span style="color:#75af00">maxPosX</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">math</span><span style="color:#111">.</span><span style="color:#75af00">Ceil</span><span style="color:#111">(</span><span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">width</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0.7</span><span style="color:#111">)</span> <span style="color:#f92672">-</span> <span style="color:#75af00">math</span><span style="color:#111">.</span><span style="color:#75af00">Ceil</span><span style="color:#111">(</span><span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">subWidth</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">1.3</span><span style="color:#111">)</span>
	<span style="color:#75af00">maxPosY</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">math</span><span style="color:#111">.</span><span style="color:#75af00">Ceil</span><span style="color:#111">(</span><span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">height</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0.7</span><span style="color:#111">)</span> <span style="color:#f92672">-</span> <span style="color:#75af00">math</span><span style="color:#111">.</span><span style="color:#75af00">Ceil</span><span style="color:#111">(</span><span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">subHeight</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">1.3</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">maxPosX</span> <span style="color:#111">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> <span style="color:#75af00">maxPosY</span> <span style="color:#111">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75715e">//todo error
</span><span style="color:#75715e"></span>		<span style="color:#75af00">tmp</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rect</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span>
		<span style="color:#00a8c8">return</span> <span style="color:#f92672">&amp;</span><span style="color:#75af00">tmp</span>
	<span style="color:#111">}</span>
	<span style="color:#75af00">posX</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">rand</span><span style="color:#111">.</span><span style="color:#75af00">Intn</span><span style="color:#111">(</span><span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">maxPosX</span><span style="color:#111">))</span> <span style="color:#f92672">+</span> <span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">math</span><span style="color:#111">.</span><span style="color:#75af00">Ceil</span><span style="color:#111">(</span><span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">width</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0.3</span><span style="color:#111">))</span>
	<span style="color:#75af00">posY</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">rand</span><span style="color:#111">.</span><span style="color:#75af00">Intn</span><span style="color:#111">(</span><span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">maxPosY</span><span style="color:#111">))</span> <span style="color:#f92672">+</span> <span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">math</span><span style="color:#111">.</span><span style="color:#75af00">Ceil</span><span style="color:#111">(</span><span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">height</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0.3</span><span style="color:#111">))</span>

	<span style="color:#75af00">log</span><span style="color:#111">.</span><span style="color:#75af00">Println</span><span style="color:#111">(</span><span style="color:#75af00">maxPosX</span><span style="color:#111">,</span> <span style="color:#75af00">maxPosY</span><span style="color:#111">)</span>
	<span style="color:#75af00">log</span><span style="color:#111">.</span><span style="color:#75af00">Println</span><span style="color:#111">(</span><span style="color:#75af00">posX</span><span style="color:#111">,</span> <span style="color:#75af00">posY</span><span style="color:#111">,</span> <span style="color:#75af00">posX</span><span style="color:#f92672">+</span><span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">subWidth</span><span style="color:#111">),</span> <span style="color:#75af00">posY</span><span style="color:#f92672">+</span><span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">subHeight</span><span style="color:#111">))</span>

	<span style="color:#75af00">retRectangle</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rect</span><span style="color:#111">(</span><span style="color:#75af00">posX</span><span style="color:#111">,</span> <span style="color:#75af00">posY</span><span style="color:#111">,</span> <span style="color:#75af00">posX</span><span style="color:#f92672">+</span><span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">subWidth</span><span style="color:#111">),</span> <span style="color:#75af00">posY</span><span style="color:#f92672">+</span><span style="color:#111">int</span><span style="color:#111">(</span><span style="color:#75af00">subHeight</span><span style="color:#111">),</span> <span style="color:#111">)</span>

	<span style="color:#00a8c8">return</span> <span style="color:#f92672">&amp;</span><span style="color:#75af00">retRectangle</span>
<span style="color:#111">}</span>
</code></pre></td></tr></tbody></table>
</div>
</div>
  </div>

  <input type="radio" class="hidden" name="tabs-go-image" id="tabs-go-image-1"/>
  <label for="tabs-go-image-1">
    shape/tilesvg.go
  </label>
  <div class="book-tabs-content markdown-inner">
    <p>绘制svg图形</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tbody><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#75af00">shape</span>

<span style="color:#f92672">import</span> <span style="color:#111">(</span>
	<span style="color:#d88200">&#34;os&#34;</span>
	<span style="color:#d88200">&#34;fmt&#34;</span>
	<span style="color:#d88200">&#34;github.com/ajstarks/svgo&#34;</span>
<span style="color:#111">)</span>

<span style="color:#00a8c8">type</span> <span style="color:#75af00">TileSvg</span> <span style="color:#00a8c8">struct</span> <span style="color:#111">{</span>
	<span style="color:#75af00">Width</span> <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">T</span>     <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">R</span>     <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">B</span>     <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">L</span>     <span style="color:#00a8c8">int</span>
<span style="color:#111">}</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e">shape svg path
</span><span style="color:#75715e"> */</span>
<span style="color:#00a8c8">func</span> <span style="color:#111">(</span><span style="color:#75af00">t</span> <span style="color:#f92672">*</span><span style="color:#75af00">TileSvg</span><span style="color:#111">)</span> <span style="color:#75af00">SaveSvg</span><span style="color:#111">(</span><span style="color:#75af00">filename</span> <span style="color:#00a8c8">string</span><span style="color:#111">,</span> <span style="color:#75af00">stroke</span> <span style="color:#00a8c8">string</span><span style="color:#111">)</span> <span style="color:#111">{</span>
	<span style="color:#75af00">width</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">Width</span>
	<span style="color:#75af00">height</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">Width</span>
	<span style="color:#75af00">f5</span><span style="color:#111">,</span> <span style="color:#75af00">_</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">os</span><span style="color:#111">.</span><span style="color:#75af00">Create</span><span style="color:#111">(</span><span style="color:#75af00">filename</span><span style="color:#111">)</span>
	<span style="color:#75af00">canvas</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">svg</span><span style="color:#111">.</span><span style="color:#75af00">New</span><span style="color:#111">(</span><span style="color:#75af00">f5</span><span style="color:#111">)</span>
	<span style="color:#75af00">canvas</span><span style="color:#111">.</span><span style="color:#75af00">Start</span><span style="color:#111">(</span><span style="color:#75af00">width</span><span style="color:#111">,</span> <span style="color:#75af00">height</span><span style="color:#111">)</span>

	<span style="color:#00a8c8">if</span> <span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#75af00">stroke</span><span style="color:#111">)</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">stroke</span> <span style="color:#111">=</span> <span style="color:#d88200">&#34;stroke-width:10;stroke:green;fill:red;&#34;</span>
	<span style="color:#111">}</span>
	<span style="color:#75af00">path</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;M%d,%d h%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>

	<span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">T</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A%d,%d 0 0,1 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">T</span> <span style="color:#111">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A%d,%d 0 1,0 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;h+%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;h%d v%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">R</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A%d,%d 0 0,1 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">4</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">R</span> <span style="color:#111">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A%d,%d 0 1,0 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">4</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;v+%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;v%d h-%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>

	<span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">B</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A%d,%d 0 0,1 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">4</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">B</span> <span style="color:#111">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;A%d,%d 0 1,0 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">4</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;h-%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;h-%d v-%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>

	<span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">L</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34; A%d,%d 0 0,1 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#00a8c8">if</span> <span style="color:#75af00">t</span><span style="color:#111">.</span><span style="color:#75af00">L</span> <span style="color:#111">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34; A%d,%d 0 1,0 %d,%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
		<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;v-%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#111">}</span>
	<span style="color:#75af00">path</span> <span style="color:#f92672">+=</span> <span style="color:#75af00">fmt</span><span style="color:#111">.</span><span style="color:#75af00">Sprintf</span><span style="color:#111">(</span><span style="color:#d88200">&#34;v-%d &#34;</span><span style="color:#111">,</span> <span style="color:#75af00">width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span>
	<span style="color:#75af00">canvas</span><span style="color:#111">.</span><span style="color:#75af00">Path</span><span style="color:#111">(</span><span style="color:#75af00">path</span><span style="color:#111">,</span> <span style="color:#75af00">stroke</span><span style="color:#111">)</span>

	<span style="color:#75af00">canvas</span><span style="color:#111">.</span><span style="color:#75af00">End</span><span style="color:#111">()</span>
<span style="color:#111">}</span>

</code></pre></td></tr></tbody></table>
</div>
</div>
  </div>

  <input type="radio" class="hidden" name="tabs-go-image" id="tabs-go-image-2"/>
  <label for="tabs-go-image-2">
    shape/tile.go
  </label>
  <div class="book-tabs-content markdown-inner">
    <p>shape/tile.go</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tbody><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">96
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#75af00">shape</span>

<span style="color:#f92672">import</span> <span style="color:#111">(</span>
	<span style="color:#d88200">&#34;image&#34;</span>
	<span style="color:#d88200">&#34;image/color&#34;</span>
<span style="color:#111">)</span>

<span style="color:#00a8c8">type</span> <span style="color:#75af00">Tile</span> <span style="color:#00a8c8">struct</span> <span style="color:#111">{</span>
	<span style="color:#75af00">Min</span>    <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Point</span>
	<span style="color:#75af00">Width</span>  <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">T</span>      <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">R</span>      <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">B</span>      <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">L</span>      <span style="color:#00a8c8">int</span>
	<span style="color:#75af00">Revert</span> <span style="color:#00a8c8">bool</span>
<span style="color:#111">}</span>

<span style="color:#00a8c8">func</span> <span style="color:#111">(</span><span style="color:#75af00">c</span> <span style="color:#f92672">*</span><span style="color:#75af00">Tile</span><span style="color:#111">)</span> <span style="color:#75af00">ColorModel</span><span style="color:#111">()</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Model</span> <span style="color:#111">{</span>
	<span style="color:#00a8c8">return</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">AlphaModel</span>
<span style="color:#111">}</span>

<span style="color:#00a8c8">func</span> <span style="color:#111">(</span><span style="color:#75af00">c</span> <span style="color:#f92672">*</span><span style="color:#75af00">Tile</span><span style="color:#111">)</span> <span style="color:#75af00">Bounds</span><span style="color:#111">()</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rectangle</span> <span style="color:#111">{</span>
	<span style="color:#00a8c8">return</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Rect</span><span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">,</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">,</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span><span style="color:#111">,</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span><span style="color:#111">)</span>
<span style="color:#111">}</span>

<span style="color:#00a8c8">func</span> <span style="color:#111">(</span><span style="color:#75af00">c</span> <span style="color:#f92672">*</span><span style="color:#75af00">Tile</span><span style="color:#111">)</span> <span style="color:#75af00">At</span><span style="color:#111">(</span><span style="color:#75af00">x</span><span style="color:#111">,</span> <span style="color:#75af00">y</span> <span style="color:#00a8c8">int</span><span style="color:#111">)</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Color</span> <span style="color:#111">{</span>

	<span style="color:#75af00">colorAt</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Alpha</span><span style="color:#111">{</span><span style="color:#ae81ff">220</span><span style="color:#111">}</span>
	<span style="color:#75af00">colorWithin</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Alpha</span><span style="color:#111">{</span><span style="color:#ae81ff">220</span><span style="color:#111">}</span>
	<span style="color:#75af00">colorWithout</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Alpha</span><span style="color:#111">{</span><span style="color:#ae81ff">0</span><span style="color:#111">}</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Revert</span> <span style="color:#111">{</span>
		<span style="color:#75af00">colorWithin</span> <span style="color:#111">=</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Alpha</span><span style="color:#111">{</span><span style="color:#ae81ff">0</span><span style="color:#111">}</span>
		<span style="color:#75af00">colorWithout</span> <span style="color:#111">=</span> <span style="color:#75af00">color</span><span style="color:#111">.</span><span style="color:#75af00">Alpha</span><span style="color:#111">{</span><span style="color:#ae81ff">220</span><span style="color:#111">}</span>
	<span style="color:#111">}</span>

	<span style="color:#75af00">margin</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">5</span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">x</span> <span style="color:#111">&gt;</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#75af00">x</span> <span style="color:#111">&lt;</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">-</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#75af00">y</span> <span style="color:#111">&gt;</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#75af00">y</span> <span style="color:#111">&lt;</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#f92672">-</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span> <span style="color:#111">{</span>
		<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithin</span>
	<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
		<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithout</span>
	<span style="color:#111">}</span>

	<span style="color:#75af00">r</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Width</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>
	<span style="color:#75715e">//todo 优化算法
</span><span style="color:#75715e"></span>
	<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">T</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">roundSpot</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Pt</span><span style="color:#111">((</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">-</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">,</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#f92672">+</span><span style="color:#75af00">margin</span><span style="color:#111">)</span>
		<span style="color:#75af00">xx</span><span style="color:#111">,</span> <span style="color:#75af00">yy</span><span style="color:#111">,</span> <span style="color:#75af00">rr</span> <span style="color:#f92672">:=</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">x</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">y</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">r</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span>
		<span style="color:#00a8c8">if</span> <span style="color:#75af00">xx</span><span style="color:#f92672">*</span><span style="color:#75af00">xx</span><span style="color:#f92672">+</span><span style="color:#75af00">yy</span><span style="color:#f92672">*</span><span style="color:#75af00">yy</span> <span style="color:#111">&lt;</span> <span style="color:#75af00">rr</span><span style="color:#f92672">*</span><span style="color:#75af00">rr</span> <span style="color:#111">{</span>
			<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">T</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithin</span>
			<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithout</span>
			<span style="color:#111">}</span>
		<span style="color:#111">}</span>
	<span style="color:#111">}</span>

	<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">R</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">roundSpot</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Pt</span><span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">-</span><span style="color:#75af00">margin</span><span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#f92672">-</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span>
		<span style="color:#75af00">xx</span><span style="color:#111">,</span> <span style="color:#75af00">yy</span><span style="color:#111">,</span> <span style="color:#75af00">rr</span> <span style="color:#f92672">:=</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">x</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">y</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">r</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span>
		<span style="color:#00a8c8">if</span> <span style="color:#75af00">xx</span><span style="color:#f92672">*</span><span style="color:#75af00">xx</span><span style="color:#f92672">+</span><span style="color:#75af00">yy</span><span style="color:#f92672">*</span><span style="color:#75af00">yy</span> <span style="color:#111">&lt;</span> <span style="color:#75af00">rr</span><span style="color:#f92672">*</span><span style="color:#75af00">rr</span> <span style="color:#111">{</span>
			<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">R</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithin</span>
			<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithout</span>
			<span style="color:#111">}</span>
		<span style="color:#111">}</span>
	<span style="color:#111">}</span>

	<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">B</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">roundSpot</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Pt</span><span style="color:#111">((</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">-</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">Y</span> <span style="color:#f92672">-</span> <span style="color:#75af00">margin</span><span style="color:#111">))</span>
		<span style="color:#75af00">xx</span><span style="color:#111">,</span> <span style="color:#75af00">yy</span><span style="color:#111">,</span> <span style="color:#75af00">rr</span> <span style="color:#f92672">:=</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">x</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">y</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">r</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span>
		<span style="color:#00a8c8">if</span> <span style="color:#75af00">xx</span><span style="color:#f92672">*</span><span style="color:#75af00">xx</span><span style="color:#f92672">+</span><span style="color:#75af00">yy</span><span style="color:#f92672">*</span><span style="color:#75af00">yy</span> <span style="color:#111">&lt;</span> <span style="color:#75af00">rr</span><span style="color:#f92672">*</span><span style="color:#75af00">rr</span> <span style="color:#111">{</span>
			<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">B</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithin</span>
			<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithout</span>
			<span style="color:#111">}</span>
		<span style="color:#111">}</span>
	<span style="color:#111">}</span>

	<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">L</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
		<span style="color:#75af00">roundSpot</span> <span style="color:#f92672">:=</span> <span style="color:#75af00">image</span><span style="color:#111">.</span><span style="color:#75af00">Pt</span><span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#f92672">+</span><span style="color:#75af00">margin</span><span style="color:#111">,</span> <span style="color:#111">(</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Bounds</span><span style="color:#111">().</span><span style="color:#75af00">Max</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#f92672">-</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span><span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">Min</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span>
		<span style="color:#75af00">xx</span><span style="color:#111">,</span> <span style="color:#75af00">yy</span><span style="color:#111">,</span> <span style="color:#75af00">rr</span> <span style="color:#f92672">:=</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">x</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">X</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">y</span><span style="color:#f92672">-</span><span style="color:#75af00">roundSpot</span><span style="color:#111">.</span><span style="color:#75af00">Y</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span> <span style="color:#111">float64</span><span style="color:#111">(</span><span style="color:#75af00">r</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span>
		<span style="color:#00a8c8">if</span> <span style="color:#75af00">xx</span><span style="color:#f92672">*</span><span style="color:#75af00">xx</span><span style="color:#f92672">+</span><span style="color:#75af00">yy</span><span style="color:#f92672">*</span><span style="color:#75af00">yy</span> <span style="color:#111">&lt;</span> <span style="color:#75af00">rr</span><span style="color:#f92672">*</span><span style="color:#75af00">rr</span> <span style="color:#111">{</span>
			<span style="color:#00a8c8">if</span> <span style="color:#75af00">c</span><span style="color:#111">.</span><span style="color:#75af00">L</span> <span style="color:#111">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithin</span>
			<span style="color:#111">}</span> <span style="color:#00a8c8">else</span> <span style="color:#111">{</span>
				<span style="color:#75af00">colorAt</span> <span style="color:#111">=</span> <span style="color:#75af00">colorWithout</span>
			<span style="color:#111">}</span>
		<span style="color:#111">}</span>
	<span style="color:#111">}</span>

	<span style="color:#00a8c8">return</span> <span style="color:#75af00">colorAt</span>
<span style="color:#111">}</span>

</code></pre></td></tr></tbody></table>
</div>
</div>
  </div>

</div><p></p>
</article>





<h3>See Also</h3>
<ul>
	
	<li><a href="/posts/notes/golang/go-imagemagick/">Go+ImageMagick使用svg+png绘制复杂图片</a></li>
	
</ul>




<script src=""></script>


 

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
  
 
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#需求-audio-preloadnoneaudio">需求 <audio preload="none" src="/audio/4b90085ccba3e856ceeec66c7256e638.mp3"></audio></a>
          <ul>
            <li></li>
            <li><a href="#先上最终最终效果">先上最终最终效果</a></li>
          </ul>
        </li>
        <li><a href="#步骤">步骤</a>
          <ul>
            <li><a href="#一go-绘制基本图形">一、go 绘制基本图形</a></li>
            <li><a href="#二imagemagick-convert把-svg-转化为-png-加阴影">二、imagemagick convert把 svg 转化为 png, 加阴影</a></li>
            <li><a href="#三处理阴影svg">三、处理阴影svg</a></li>
          </ul>
        </li>
        <li><a href="#附go代码">附go代码：</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  

  <script src="/js/audiojs/audio.min.js"></script>
  <script src="/js/audiojs/custom.js"></script>















</body></html>